go/consensus: Move upgrade logic to governance, gracefully handle halt
